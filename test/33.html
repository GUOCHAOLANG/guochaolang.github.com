<!--
使用的前提是这个要用IE打开，否则无用
-->

<html>  
<head>  
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">  
<style>
a:hover{color:blue;cursor:default;}
</style> 
<script>
//获取当前文件的根目录
var rootUrl
function getroot(){
	var strUrl=window.location.href
	var arrUrl=strUrl.split("/")
	var strPage=arrUrl[arrUrl.length-1]
	strUrl=strUrl.replace("file:///","")
	strUrl=strUrl.replace("/"+strPage,"")
	return strUrl
}
var level = 0

var rootfileList
//var rootindex = 0;
var isFolder

//搜索
var fso = new ActiveXObject("Scripting.FileSystemObject");  
function searchFilesList(filePath){
	myfiles.innerHTML+=rootUrl+"<br>"
	//rootUrl = ""+filePath
	myfiles.innerHTML+=rootUrl+"<br>"
	rootfileList = new Array()
	myfiles.innerHTML+=rootUrl+"<br>"
	isFolder = new Array()
	myfiles.innerHTML+=rootUrl+"<br>"
	var rootindex = 0
	var isindex = 0
	myfiles.innerHTML+=rootUrl+"<br>"
	var f = fso.GetFolder(rootUrl) 
	myfiles.innerHTML=rootUrl+"<br>"
	// 遍历目录  
	var fk = new Enumerator(f.SubFolders) 
	myfiles.innerHTML+=rootUrl+"<br>"
	for (; !fk.atEnd(); fk.moveNext()){
		rootfileList[rootindex++] = fk.item()
		isFolder[isindex++] = 1
	} 
	myfiles.innerHTML+=rootUrl+"<br>"
	// 遍历目录文件  
	var fc = new Enumerator(f.files);  
	for (; !fc.atEnd(); fc.moveNext()) {  
		rootfileList[rootindex++] = fc.item();
		isFolder[isindex++] = 0
	}  
}

function rootsearchFiles(){
	rootUrl = getroot()+"/"
	
	searchFilesList(""+rootUrl)
	myfiles.innerHTML+=rootUrl+"<br>"
}
 
function csearchFiles(newUrl){
	level+=1
	for (var i=0; i<rootfileList.length; i++){  
		if(i==newUrl){
			newUrl=""+rootfileList[i]
		}
	}
	//rootUrl = getroot()
	//将/替换为\\
	newUrl=newUrl.replace(/\//g,"\\")
	searchFilesList(newUrl)
	myfiles.innerHTML=""	//清空显示
	//返回
	if(level>0){
		myfiles.innerHTML+="<a onClick=bsearchFiles()>......</a><br>"
	}
	// 循环输出信息  
	for (var i=0; i<rootfileList.length; i++){ 
		var is = ""+isFolder[i]
		if(is == "1"){
			myfiles.innerHTML+="<a onClick=csearchFiles("+i+")>"+rootfileList[i]+"</a><br>"
		}else{
			myfiles.innerHTML+=rootfileList[i]+"<br>"
		}
	}  
}  
function bsearchFiles(){
	level-=1
	//rootUrl = getroot()
	//rootUrl的上一级
	var arrUrl=rootUrl.split("\\");
	var strPage="\\"+arrUrl[arrUrl.length-1];
	rootUrl=rootUrl.replace(strPage,"");
	//将/替换为\\
	rootUrl=rootUrl.replace(/\//g,"\\")
	searchFilesList(rootUrl)
	myfiles.innerHTML=""	//清空显示
	if(level>0){
		myfiles.innerHTML+="<a onClick=bsearchFiles()>......</a><br>"
	}
	// 循环输出信息  
	for (var i=0; i<rootfileList.length; i++){ 
		var is = ""+isFolder[i]
		if(is == "1"){
			myfiles.innerHTML+="<a onClick=csearchFiles("+i+")>"+rootfileList[i]+"</a><br>"
		}else{
			myfiles.innerHTML+=rootfileList[i]+"<br>"
		}
	}  
}  
</script>  
</head>  
<body bgcolor="#FFFFFF" onload="rootsearchFiles()"> 
<div id= "myfiles">
</div>  
</body>  
</html>  
